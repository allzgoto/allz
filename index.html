<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Shadow Fight — Cut Entry</title>

<style>
  *{margin:0;padding:0;box-sizing:border-box}
  html,body{width:100%;height:100%;overflow:hidden;background:#000}
  :root{
    --ember: rgba(255,140,70,0.85);
    --emberSoft: rgba(255,170,110,0.25);
    --gold: rgba(210,170,80,0.22);
    --paper1: #0b0a08;
    --paper2: #050505;
  }

  /* Vídeo principal */
  #mainVideo{
    position:fixed; inset:0;
    width:100%; height:100%;
    object-fit:cover;
    z-index:0;
    opacity:0;
    transition:opacity 700ms ease;
    filter:contrast(1.08) saturate(0.9);
  }
  body.entered #mainVideo{opacity:1}

  /* ENTRY */
  #entry{
    position:fixed; inset:0;
    z-index:10;
    display:grid;
    place-items:center;
    cursor:pointer;
    user-select:none;
    background:linear-gradient(to bottom, var(--paper1), var(--paper2));
  }

  /* Pergaminho sujo (sem imagem) */
  #entry::before{
    content:"";
    position:absolute; inset:-60px;
    background:
      radial-gradient(circle at 20% 30%, rgba(255,255,255,0.05), transparent 55%),
      radial-gradient(circle at 75% 55%, rgba(255,255,255,0.035), transparent 58%),
      radial-gradient(circle at 50% 85%, rgba(255,140,70,0.03), transparent 55%),
      repeating-linear-gradient(100deg, rgba(255,255,255,0.02) 0 2px, transparent 2px 18px),
      repeating-linear-gradient(0deg, rgba(0,0,0,0.42) 0 1px, transparent 1px 5px);
    opacity:.95;
    filter:blur(0.25px);
    pointer-events:none;
  }

  /* Vinheta pesada */
  #entry::after{
    content:"";
    position:absolute; inset:0;
    background:
      radial-gradient(circle at center, rgba(0,0,0,0.10) 20%, rgba(0,0,0,0.92) 100%);
    pointer-events:none;
  }

  /* Partículas/poeira */
  #dust{
    position:absolute; inset:0;
    z-index:1;
    pointer-events:none;
  }

  /* “chão” laranja queimado bem fraco */
  .ground-glow{
    position:absolute;
    left:0; right:0; bottom:-18%;
    height:55%;
    z-index:2;
    background:radial-gradient(circle at 50% 90%, rgba(255,140,70,0.10), transparent 62%);
    filter:blur(12px);
    pointer-events:none;
    opacity:.9;
  }

  /* Container principal */
  .stage{
    position:relative;
    width:min(980px, 94vw);
    height:min(620px, 82vh);
    display:grid;
    place-items:center;
    z-index:5;
  }

  /* Silhueta do guerreiro (shape simples, mas funciona MUITO) */
  .shadow{
    position:relative;
    width:min(360px, 46vw);
    aspect-ratio: 1/1.25;
    filter:drop-shadow(0 0 22px rgba(255,140,70,0.06));
    opacity:.95;
    transform:translateY(10px);
    transition:transform 700ms cubic-bezier(.2,.9,.2,1), opacity 700ms ease;
  }

  /* Corpo */
  .shadow .body{
    position:absolute;
    left:50%; top:55%;
    width:32%;
    height:42%;
    transform:translate(-50%,-50%);
    background:#000;
    border-radius:22px;
    box-shadow:inset 0 0 0 2px rgba(255,255,255,0.03);
  }

  /* Cabeça */
  .shadow .head{
    position:absolute;
    left:50%; top:28%;
    width:18%;
    height:18%;
    transform:translate(-50%,-50%);
    background:#000;
    border-radius:50%;
  }

  /* Ombros */
  .shadow .shoulder{
    position:absolute;
    top:42%;
    width:26%;
    height:18%;
    background:#000;
    border-radius:28px;
  }
  .shadow .shoulder.left{ left:34%; transform:rotate(-12deg); }
  .shadow .shoulder.right{ right:34%; transform:rotate(12deg); }

  /* Pernas */
  .shadow .leg{
    position:absolute;
    top:70%;
    width:14%;
    height:30%;
    background:#000;
    border-radius:18px;
  }
  .shadow .leg.left{ left:44%; transform:rotate(8deg); transform-origin:top; }
  .shadow .leg.right{ right:44%; transform:rotate(-10deg); transform-origin:top; }

  /* Espada (silhueta) */
  .shadow .sword{
    position:absolute;
    left:62%;
    top:42%;
    width:46%;
    height:8%;
    transform:translate(-50%,-50%) rotate(-18deg);
    transform-origin:18% 50%;
    transition:transform 620ms cubic-bezier(.2,.9,.2,1);
  }
  .shadow .sword::before{
    content:"";
    position:absolute;
    left:0; top:50%;
    width:78%;
    height:28%;
    transform:translateY(-50%);
    background:#000;
    border-radius:10px;
  }
  .shadow .sword::after{
    content:"";
    position:absolute;
    left:68%;
    top:50%;
    width:26%;
    height:18%;
    transform:translateY(-50%);
    background:#000;
    border-radius:8px;
  }

  /* Texto “Desperte a Sombra” */
  .title{
    position:absolute;
    bottom:26px;
    width:100%;
    text-align:center;
    font-size:12px;
    letter-spacing:6px;
    text-transform:uppercase;
    color:rgba(220,190,110,0.22);
    z-index:6;
  }
  .subtitle{
    position:absolute;
    bottom:8px;
    width:100%;
    text-align:center;
    font-size:12px;
    letter-spacing:4px;
    color:rgba(255,255,255,0.18);
    z-index:6;
  }

  /* Linha dourada “gasta” */
  .divider{
    position:absolute;
    bottom:18px;
    left:50%;
    width:min(520px, 80vw);
    height:1px;
    transform:translateX(-50%);
    background:linear-gradient(90deg, transparent, var(--gold), transparent);
    opacity:.55;
  }

  /* CORTE (slash) */
  .slash{
    position:fixed;
    inset:-30%;
    z-index:9;
    pointer-events:none;
    opacity:0;
    transform:rotate(-18deg) translateX(-50%);
    background:linear-gradient(90deg,
      transparent 0%,
      rgba(255,180,110,0.20) 44%,
      rgba(255,140,70,0.75) 50%,
      rgba(255,180,110,0.20) 56%,
      transparent 100%);
    filter:blur(0.2px);
  }

  /* Rasgo que abre */
  .tear{
    position:fixed;
    left:50%;
    top:-10%;
    height:120%;
    width:12px;
    transform:translateX(-50%);
    z-index:10;
    opacity:0;
    pointer-events:none;
    background:linear-gradient(to bottom,
      rgba(0,0,0,0) 0%,
      rgba(0,0,0,0.98) 18%,
      rgba(0,0,0,1) 50%,
      rgba(0,0,0,0.98) 82%,
      rgba(0,0,0,0) 100%);
  }
  .tear::before{
    content:"";
    position:absolute; inset:-14px;
    background:
      repeating-linear-gradient(
        to bottom,
        rgba(255,255,255,0.0) 0 8px,
        rgba(255,140,70,0.10) 8px 10px,
        rgba(255,255,255,0.0) 10px 18px
      );
    opacity:.7;
    filter:blur(1.3px);
    mix-blend-mode:screen;
  }

  /* Engolir pro preto */
  .swallow{
    position:fixed; inset:0;
    z-index:11;
    pointer-events:none;
    opacity:0;
    background:radial-gradient(circle at center,
      rgba(255,140,70,0.00) 0%,
      rgba(255,140,70,0.18) 35%,
      rgba(0,0,0,1) 74%);
    transform:scale(0.9);
  }

  /* ===== Clique sequência ===== */
  body.drawing .shadow .sword{
    transform:translate(-50%,-50%) rotate(-55deg);
  }
  body.drawing .shadow{
    transform:translateY(6px);
  }

  body.slashing .slash{
    opacity:1;
    animation:slashMove 260ms ease forwards;
  }
  @keyframes slashMove{
    0%{transform:rotate(-18deg) translateX(-60%)}
    100%{transform:rotate(-18deg) translateX(60%)}
  }

  body.slashing .tear{
    opacity:1;
    animation:tearGrow 520ms ease forwards;
  }
  @keyframes tearGrow{
    0%{width:10px}
    100%{width:86px}
  }

  body.slashing .swallow{
    opacity:1;
    transform:scale(1.25);
    transition:opacity 520ms ease, transform 520ms cubic-bezier(.12,.92,.12,1);
  }

  body.entered #entry{
    opacity:0;
    pointer-events:none;
    transition:opacity 520ms ease;
  }

  @media (prefers-reduced-motion: reduce){
    body.slashing .slash{animation:none; opacity:1}
    body.slashing .tear{animation:none; opacity:1; width:86px}
  }
</style>
</head>

<body>
  <video
    id="mainVideo"
    src="https://files.catbox.moe/klaol5.webm"
    playsinline
    preload="auto"
    muted
    loop
  ></video>

  <section id="entry" aria-label="Entrada Shadow Fight">
    <canvas id="dust"></canvas>
    <div class="ground-glow" aria-hidden="true"></div>

    <div class="stage">
      <div class="shadow" id="shadow">
        <div class="head"></div>
        <div class="shoulder left"></div>
        <div class="shoulder right"></div>
        <div class="body"></div>
        <div class="leg left"></div>
        <div class="leg right"></div>
        <div class="sword"></div>
      </div>

      <div class="divider" aria-hidden="true"></div>
      <div class="title">DESPERTE A SOMBRA</div>
      <div class="subtitle">CLIQUE PARA ENTRAR</div>
    </div>

    <div class="slash" aria-hidden="true"></div>
    <div class="tear" aria-hidden="true"></div>
    <div class="swallow" aria-hidden="true"></div>
  </section>

<script>
  const entry = document.getElementById("entry");
  const mainVideo = document.getElementById("mainVideo");

  // ===== poeira / brasas (canvas) =====
  const canvas = document.getElementById("dust");
  const ctx = canvas.getContext("2d", { alpha:true });
  let W=0,H=0,DPR=1;

  const dust = [];
  const COUNT = 140;

  const rand=(a,b)=>Math.random()*(b-a)+a;

  function resize(){
    DPR = devicePixelRatio || 1;
    W = canvas.width = innerWidth * DPR;
    H = canvas.height = innerHeight * DPR;
  }
  addEventListener("resize", resize);
  resize();

  function spawn(){
    return {
      x: rand(-W*0.1, W*1.1),
      y: rand(0, H),
      r: rand(0.6, 2.8)*DPR,
      vx: rand(0.10, 0.55)*DPR,   // vento lateral
      vy: rand(-0.12, -0.55)*DPR, // sobe um pouco
      a: rand(0.02, 0.18),
      wob: rand(0.002, 0.008),
      life: rand(0.7, 1.3)
    };
  }
  for(let i=0;i<COUNT;i++) dust.push(spawn());

  function draw(){
    ctx.clearRect(0,0,W,H);

    // vento/poeira: mais concentrado no meio-baixo
    for(const p of dust){
      p.x += p.vx + Math.sin(p.y*p.wob)*(0.35*DPR);
      p.y += p.vy;

      // “recicla” quando sai da tela
      if(p.x > W+80 || p.y < -80){
        Object.assign(p, spawn());
        p.x = -60;
        p.y = rand(H*0.45, H*1.05);
      }

      const alpha = Math.max(0, Math.min(0.30, p.a))*p.life;
      ctx.beginPath();
      ctx.fillStyle = `rgba(255, 170, 110, ${alpha*0.35})`;
      ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
      ctx.fill();

      // brilho laranja pontual (brasinha)
      if(p.r > 2.2*DPR){
        ctx.beginPath();
        ctx.fillStyle = `rgba(255, 140, 70, ${alpha*0.20})`;
        ctx.arc(p.x, p.y, p.r*0.8, 0, Math.PI*2);
        ctx.fill();
      }
    }

    requestAnimationFrame(draw);
  }
  draw();

  // ===== som “corte” (WebAudio simples) =====
  function playSlash(){
    try{
      const AC = window.AudioContext || window.webkitAudioContext;
      const ac = new AC();
      const now = ac.currentTime;

      // ruído (vento/corte)
      const len = Math.floor(ac.sampleRate * 0.16);
      const buf = ac.createBuffer(1, len, ac.sampleRate);
      const d = buf.getChannelData(0);
      for(let i=0;i<d.length;i++){
        d[i] = (Math.random()*2-1) * (1 - i/d.length);
      }
      const noise = ac.createBufferSource();
      noise.buffer = buf;

      const hp = ac.createBiquadFilter();
      hp.type = "highpass";
      hp.frequency.setValueAtTime(700, now);

      const g = ac.createGain();
      g.gain.setValueAtTime(0.0001, now);
      g.gain.exponentialRampToValueAtTime(0.18, now+0.02);
      g.gain.exponentialRampToValueAtTime(0.0001, now+0.16);

      noise.connect(hp);
      hp.connect(g);
      g.connect(ac.destination);

      // “metal” curtinho
      const osc = ac.createOscillator();
      osc.type = "triangle";
      osc.frequency.setValueAtTime(520, now);
      osc.frequency.exponentialRampToValueAtTime(210, now+0.12);

      const og = ac.createGain();
      og.gain.setValueAtTime(0.0001, now);
      og.gain.exponentialRampToValueAtTime(0.10, now+0.02);
      og.gain.exponentialRampToValueAtTime(0.0001, now+0.14);

      osc.connect(og);
      og.connect(ac.destination);

      noise.start(now);
      noise.stop(now+0.16);

      osc.start(now);
      osc.stop(now+0.14);

      setTimeout(()=>ac.close().catch(()=>{}), 600);
    }catch(e){}
  }

  // ===== sequência clique =====
  let started=false;
  function start(){
    if(started) return;
    started=true;

    // começa o vídeo dentro do gesto do clique
    mainVideo.play().catch(()=>{});

    // 1) puxa espada (micro)
    document.body.classList.add("drawing");

    // 2) corte / rasgo / engolir
    setTimeout(()=>{
      playSlash();
      document.body.classList.add("slashing");
    }, 420);

    // 3) entra no vídeo
    setTimeout(()=>{
      document.body.classList.add("entered");
      setTimeout(()=>{ entry.style.display="none"; }, 650);
    }, 1150);
  }

  entry.addEventListener("pointerdown", start);
  entry.addEventListener("keydown", (e)=>{
    if(e.key==="Enter" || e.key===" "){ e.preventDefault(); start(); }
  });
  entry.tabIndex = 0;
</script>
</body>
</html>

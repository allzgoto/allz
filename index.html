<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Shadow Temple Interface</title>

<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@500;700&family=Inter:wght@400;500&display=swap" rel="stylesheet" />

<style>
:root{
  --ink:#05060a;
  --coal:#0a0c11;

  --txt: rgba(245,248,255,.92);
  --dim: rgba(245,248,255,.62);

  /* acento mais “templo/ferro” (âmbar queimado) */
  --gold: rgba(200, 160, 80, .95);
  --gold2: rgba(200, 160, 80, .22);
  --gold3: rgba(200, 160, 80, .10);

  --line: rgba(255,255,255,.07);

  --blur-amount: 26px;
  --enter-scale: 1;
}

*{margin:0;padding:0;box-sizing:border-box;}
html,body{height:100%;}
body{
  background:var(--ink);
  overflow:hidden;
  color:var(--txt);
  font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
}

/* ========= VIDEO LAYERS ========= */
#videoBlur{
  position:fixed;
  inset:-20%;
  width:140%;
  height:140%;
  object-fit:cover;
  filter: blur(var(--blur-amount)) brightness(.40) saturate(1.05) contrast(1.05);
  transform: translateZ(0);
  z-index:-5;
}
#video{
  position:fixed;
  inset:0;
  width:100%;
  height:100%;
  object-fit:cover;
  z-index:-4;
  background:black;
  filter: brightness(.40) contrast(1.02) saturate(1.0);
  transform: translateZ(0);
}

/* quando entra: vídeo “abre” e clareia */
body.entered #video{
  animation: videoBloom 1.2s ease forwards;
}
@keyframes videoBloom{
  0%{ filter: brightness(.40) contrast(1.02) saturate(1.0); transform: scale(1.02); }
  100%{ filter: brightness(.88) contrast(1.06) saturate(1.05); transform: scale(1); }
}

/* ========= FX ========= */
.scanlines{
  position:fixed; inset:0;
  background:repeating-linear-gradient(
    to bottom,
    rgba(255,255,255,0.018),
    rgba(255,255,255,0.018) 1px,
    transparent 1px,
    transparent 5px
  );
  pointer-events:none;
  z-index:3;
  mix-blend-mode:overlay;
  opacity:.45;
}
#cinemaFX{
  position:fixed; inset:0;
  pointer-events:none;
  z-index:4;
}
#cinemaFX::before{
  content:"";
  position:absolute; inset:-20%;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='180' height='180'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='.35'/%3E%3C/svg%3E");
  opacity:.055;
  mix-blend-mode:overlay;
  animation:grain 6s steps(10) infinite;
}
#cinemaFX::after{
  content:"";
  position:absolute; inset:0;
  background:
    radial-gradient(circle at 50% 48%, transparent 0 60%, rgba(0,0,0,.55) 82%, rgba(0,0,0,.78) 100%);
  opacity:.68;
}
@keyframes grain{
  0%{transform:translate(0,0)}
  10%{transform:translate(-2%, -3%)}
  20%{transform:translate(-4%, 2%)}
  30%{transform:translate(3%, -2%)}
  40%{transform:translate(2%, 4%)}
  50%{transform:translate(-3%, 2%)}
  60%{transform:translate(4%, 0%)}
  70%{transform:translate(0%, 3%)}
  80%{transform:translate(-2%, -2%)}
  90%{transform:translate(3%, 1%)}
  100%{transform:translate(0,0)}
}

/* flash da ruptura */
#ruptureFlash{
  position:fixed; inset:0;
  pointer-events:none;
  z-index:12;
  opacity:0;
  background:
    radial-gradient(circle at 50% 50%, rgba(200,160,80,.18), transparent 55%),
    repeating-linear-gradient(0deg, rgba(255,255,255,.06) 0 1px, transparent 1px 6px);
  mix-blend-mode:screen;
}
body.rupturing #ruptureFlash{ animation: flash .65s steps(6) 1; }
@keyframes flash{
  0%{opacity:0}
  15%{opacity:1; transform:translateX(8px)}
  30%{opacity:.25; transform:translateX(-10px)}
  55%{opacity:1; transform:translateX(6px)}
  80%{opacity:.20; transform:translateX(-6px)}
  100%{opacity:0; transform:none}
}

/* tremor da tela */
body.shake{
  animation: shake .55s ease 1;
}
@keyframes shake{
  0%{transform:translate(0,0)}
  20%{transform:translate(2px,-2px)}
  40%{transform:translate(-3px,2px)}
  60%{transform:translate(2px,2px)}
  80%{transform:translate(-2px,-1px)}
  100%{transform:translate(0,0)}
}
</style>
</head>
<style>
/* ========= INÍCIO (SELO) ========= */
#intro{
  position:fixed; inset:0;
  z-index:20;
  display:grid;
  place-items:center;
  background: radial-gradient(circle at 50% 50%, rgba(10,12,16,.25), rgba(0,0,0,.65));
  transition: opacity .55s ease, transform .55s ease;
}
body.entered #intro{
  opacity:0;
  pointer-events:none;
  transform: scale(1.01);
}

/* nada de card “grande” — só uma presença sutil */
.introWrap{
  width:min(680px, calc(100vw - 44px));
  padding:28px 20px 26px 20px;
  text-align:center;
  position:relative;
}
.introTitle{
  font-family:Cinzel, serif;
  letter-spacing:6px;
  font-size:11px;
  opacity:.82;
  text-shadow:0 0 16px rgba(0,0,0,.7);
}

/* selo central */
.sealZone{
  margin-top:16px;
  display:grid;
  place-items:center;
  position:relative;
}

/* halo fino (não sci-fi) */
.sealHalo{
  position:absolute;
  width:260px; height:260px;
  border-radius:50%;
  border:1px solid rgba(200,160,80,.16);
  box-shadow:
    0 0 0 1px rgba(0,0,0,.40) inset,
    0 0 28px rgba(200,160,80,.06);
  opacity:.8;
  transform: scale(var(--enter-scale));
}
.sealHalo::after{
  content:"";
  position:absolute; inset:-2px;
  border-radius:50%;
  border:1px dashed rgba(200,160,80,.10);
  opacity:.75;
}

/* o SELO (imagem) */
#sealBtn{
  width:140px; height:140px;
  border:none;
  background:transparent;
  cursor:pointer;
  position:relative;
  display:grid;
  place-items:center;
  outline:none;
  transform: translateZ(0);
}
#sealBtn img{
  width:100%;
  height:100%;
  object-fit:contain;
  filter: drop-shadow(0 0 22px rgba(200,160,80,.10));
  opacity:.95;
  transform: scale(1);
  transition: transform .18s ease, filter .18s ease, opacity .18s ease;
}
#sealBtn:hover img{
  transform: scale(1.03);
  filter: drop-shadow(0 0 34px rgba(200,160,80,.18));
  opacity:1;
}

/* “respiração” do selo antes de clicar */
body:not(.entered) #sealBtn img{
  animation: breathe 2.8s ease-in-out infinite;
}
@keyframes breathe{
  0%,100%{ transform:scale(1); filter: drop-shadow(0 0 18px rgba(200,160,80,.10)); }
  50%{ transform:scale(1.02); filter: drop-shadow(0 0 34px rgba(200,160,80,.18)); }
}

/* rachadura/ruptura: overlay fake de cracks */
.cracks{
  position:absolute;
  width:220px; height:220px;
  border-radius:50%;
  pointer-events:none;
  opacity:0;
  background:
    repeating-linear-gradient(18deg, rgba(200,160,80,.0) 0 10px, rgba(200,160,80,.10) 10px 11px, rgba(0,0,0,0) 11px 20px),
    repeating-linear-gradient(-22deg, rgba(200,160,80,.0) 0 12px, rgba(200,160,80,.08) 12px 13px, rgba(0,0,0,0) 13px 22px);
  filter: blur(.2px);
  mix-blend-mode:screen;
}
body.rupturing .cracks{
  animation: crackIn .95s ease 1 forwards;
}
@keyframes crackIn{
  0%{opacity:0; transform:scale(.92) rotate(0deg)}
  35%{opacity:.55; transform:scale(1.02) rotate(8deg)}
  70%{opacity:.22; transform:scale(1.06) rotate(-6deg)}
  100%{opacity:0; transform:scale(1.10) rotate(0deg)}
}

.introHint{
  margin-top:16px;
  font-family:Cinzel, serif;
  letter-spacing:4px;
  font-size:9px;
  color:rgba(245,248,255,.74);
  opacity:.85;
  text-shadow:0 0 18px rgba(0,0,0,.75);
}
.introHint .sub{
  display:block;
  margin-top:7px;
  font-family:Inter, system-ui, sans-serif;
  letter-spacing:2px;
  font-size:10px;
  opacity:.55;
}

/* rodapé discreto */
.introFoot{
  margin-top:18px;
  display:flex;
  justify-content:space-between;
  gap:12px;
  opacity:.35;
  font-family:Cinzel, serif;
  font-size:9px;
  letter-spacing:3px;
}

/* ========= TOP HUD (aparece só depois que entra) ========= */
#topHUD{
  position:fixed;
  top:14px;
  left:14px;
  z-index:25;
  display:flex;
  gap:10px;
  opacity:0;
  pointer-events:none;
  transition: opacity .35s ease, transform .35s ease;
  transform: translateY(-6px);
}
body.entered #topHUD{
  opacity:.92;
  pointer-events:auto;
  transform:none;
}

.hudBtn{
  width:44px;height:38px;
  border-radius:14px;
  border:1px solid rgba(200,160,80,.18);
  background:
    radial-gradient(circle at 30% 30%, rgba(255,255,255,.05), transparent 60%),
    linear-gradient(180deg, rgba(10,12,16,.62), rgba(0,0,0,.48));
  backdrop-filter: blur(14px);
  cursor:pointer;
  display:grid;
  place-items:center;
  box-shadow:0 0 0 1px rgba(0,0,0,.35) inset, 0 14px 42px rgba(0,0,0,.42);
  color:rgba(245,248,255,.92);
}
.hudBtn:hover{
  box-shadow:0 0 0 1px rgba(0,0,0,.35) inset, 0 18px 52px rgba(0,0,0,.50), 0 0 26px rgba(200,160,80,.10);
  transform: translateY(-1px);
}
.hudBtn:active{transform:translateY(1px);}
.hudBtn svg{width:18px;height:18px;opacity:.92; filter: drop-shadow(0 0 12px rgba(200,160,80,.10));}

/* mini painel volume */
#volPanel{
  position:absolute;
  top:46px;
  left:0;
  width:240px;
  padding:10px 12px;
  border-radius:14px;
  border:1px solid rgba(200,160,80,.14);
  background: rgba(0,0,0,.55);
  backdrop-filter: blur(14px);
  box-shadow:0 18px 60px rgba(0,0,0,.55);
  opacity:0;
  pointer-events:none;
  transform: translateY(-6px);
  transition:.2s ease;
}
#volWrap.open #volPanel{
  opacity:1;
  pointer-events:auto;
  transform:none;
}
.volTop{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:8px;
  font-family:Cinzel, serif;
  letter-spacing:3px;
  font-size:9px;
  opacity:.9;
}
#volRead{ opacity:.75; letter-spacing:2px; font-family:Inter, system-ui, sans-serif; font-size:12px;}
#volSlider{
  width:100%;
  appearance:none;
  -webkit-appearance:none;
  height:26px;
  background:transparent;
  cursor:pointer;
}
#volSlider::-webkit-slider-runnable-track{
  height:6px;border-radius:999px;
  background: linear-gradient(90deg, rgba(245,248,255,.70), rgba(200,160,80,.18));
  border:1px solid rgba(200,160,80,.14);
}
#volSlider::-webkit-slider-thumb{
  -webkit-appearance:none;
  width:16px;height:16px;border-radius:7px;
  margin-top:-6px;
  background: radial-gradient(circle at 30% 30%, rgba(245,248,255,1), rgba(200,160,80,.30));
  border:1px solid rgba(200,160,80,.22);
}

@media (max-width:520px){
  .sealHalo{width:220px;height:220px;}
  #sealBtn{width:124px;height:124px;}
}
</style>
</head>

<body>

<!-- Vídeo (já existe, mas fica escuro até o selo romper) -->
<video id="videoBlur" playsinline preload="auto" muted loop>
  <source src="https://files.catbox.moe/klaol5.webm" type="video/webm" />
</video>

<video id="video" playsinline preload="auto" loop>
  <source src="https://files.catbox.moe/klaol5.webm" type="video/webm" />
</video>

<audio id="ambience" preload="auto" loop>
  <source src="https://files.catbox.moe/99fu05.m4a" type="audio/mp4">
</audio>

<div class="scanlines"></div>
<div id="cinemaFX"></div>
<div id="ruptureFlash"></div>

<!-- HUD topo (só depois que entra) -->
<div id="topHUD">
  <div id="volWrap" style="position:relative;">
    <button class="hudBtn" id="btnVol" title="ECO" aria-label="Volume">
      <!-- ícone “pergaminho/eco” simples -->
      <svg viewBox="0 0 24 24" aria-hidden="true">
        <path d="M7 9V7a2 2 0 0 1 2-2h3l3-2v18l-3-2H9a2 2 0 0 1-2-2v-2"
          fill="none" stroke="rgba(245,248,255,.88)" stroke-width="1.7" stroke-linejoin="round"/>
        <path d="M17.5 9.2a4.6 4.6 0 0 1 0 5.6"
          fill="none" stroke="rgba(245,248,255,.62)" stroke-width="1.7" stroke-linecap="round"/>
      </svg>
    </button>

    <div id="volPanel">
      <div class="volTop">
        <span>ECO</span>
        <span id="volRead">45%</span>
      </div>
      <input id="volSlider" type="range" min="0" max="1" step="0.01" value="0.45" />
    </div>
  </div>

  <button class="hudBtn" id="btnFS" title="Tela cheia" aria-label="Tela cheia">
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path d="M8 3H5a2 2 0 0 0-2 2v3M16 3h3a2 2 0 0 1 2 2v3M8 21H5a2 2 0 0 1-2-2v-3M16 21h3a2 2 0 0 0 2-2v-3"
        fill="none" stroke="rgba(245,248,255,.88)" stroke-width="1.7" stroke-linecap="round"/>
    </svg>
  </button>
</div>

<!-- INÍCIO (SELO) -->
<section id="intro" aria-label="Início">
  <div class="introWrap">
    <div class="introTitle">SELOS SE FECHAM…</div>

    <div class="sealZone">
      <div class="sealHalo" aria-hidden="true"></div>
      <div class="cracks" aria-hidden="true"></div>

      <button id="sealBtn" type="button" aria-label="Romper o selo">
        <img src="https://files.catbox.moe/l6h4rv.png" alt="Selo" />
      </button>
    </div>

    <div class="introHint">
      TOQUE NO SELO PARA ROMPER O PORTAL
      <span class="sub">ou pressione [ENTER]</span>
    </div>

    <div class="introFoot">
      <span>TEMPLO // VIGIA</span>
      <span>SHADOW TEMPLE INTERFACE: V1</span>
    </div>
  </div>
</section>
<script>
/* ===== ELEMENTS ===== */
const video = document.getElementById("video");
const videoBlur = document.getElementById("videoBlur");
const ambience = document.getElementById("ambience");

const intro = document.getElementById("intro");
const sealBtn = document.getElementById("sealBtn");

const btnFS = document.getElementById("btnFS");
const btnVol = document.getElementById("btnVol");
const volWrap = document.getElementById("volWrap");
const volSlider = document.getElementById("volSlider");
const volRead = document.getElementById("volRead");

/* ===== STATE ===== */
let hasEntered = false;
let entering = false;

/* ===== INITIAL BEHAVIOR (B) =====
- vídeo carrega, mas fica “travado/escuro”
- só toca após romper selo
*/
function hardStop(){
  try{ video.pause(); video.currentTime = 0; }catch(e){}
  try{ videoBlur.pause(); videoBlur.currentTime = 0; }catch(e){}
  try{ ambience.pause(); ambience.currentTime = 0; }catch(e){}
}
document.addEventListener("DOMContentLoaded", hardStop);
window.addEventListener("pageshow", hardStop);

/* ===== VOLUME DEFAULT 45% ===== */
video.volume = 0.45;
volSlider.value = String(video.volume);
function updateVolUI(){
  const pct = Math.round(video.volume * 100);
  volRead.textContent = pct + "%";
  // ambience sempre mais baixo que o vídeo
  ambience.volume = Math.min(0.22, Math.max(0.02, video.volume * 0.20));
}
updateVolUI();

volSlider.addEventListener("input", () => {
  video.volume = Number(volSlider.value);
  updateVolUI();
});
btnVol.addEventListener("click", (e) => {
  e.stopPropagation();
  volWrap.classList.toggle("open");
});
document.addEventListener("click", () => volWrap.classList.remove("open"));

/* ===== FULLSCREEN ===== */
async function toggleFullscreen(){
  try{
    if (!document.fullscreenElement) await document.documentElement.requestFullscreen();
    else await document.exitFullscreen();
  }catch(e){}
}
btnFS.addEventListener("click", toggleFullscreen);

/* ===== ENTER RUPTURE SEQUENCE ===== */
function doRupture(){
  if (hasEntered || entering) return;
  entering = true;

  // Stage A: respira + micro tremor
  document.body.classList.add("shake");

  // Stage B: rachaduras + flash
  setTimeout(() => {
    document.body.classList.remove("shake");
    document.body.classList.add("rupturing");
  }, 180);

  // Stage C: libera vídeo (remove overlay, play)
  setTimeout(async () => {
    hasEntered = true;
    document.body.classList.remove("rupturing");
    document.body.classList.add("entered");

    // sincroniza blur
    try{ await videoBlur.play(); }catch(e){}
    try{ await video.play(); }catch(e){}

    // áudio ambiente entra junto (se o navegador permitir)
    try{ await ambience.play(); }catch(e){}

    // trava overlay
    intro.style.pointerEvents = "none";
  }, 720);
}

sealBtn.addEventListener("click", doRupture);
document.addEventListener("keydown", (e) => {
  if (e.key === "Enter") doRupture();
});

/* ===== VISIBILITY SAFETY ===== */
document.addEventListener("visibilitychange", () => {
  if (document.hidden){
    try{ video.pause(); }catch(e){}
    try{ videoBlur.pause(); }catch(e){}
    try{ ambience.pause(); }catch(e){}
    return;
  }
  if (!hasEntered){
    hardStop();
    return;
  }
  video.play().catch(()=>{});
  videoBlur.play().catch(()=>{});
  ambience.play().catch(()=>{});
});
</script>

</body>
</html>

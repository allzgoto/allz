<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Shadow Temple Interface // v2</title>

<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@500;700&family=Inter:wght@400;500&display=swap" rel="stylesheet" />

<style>
:root{
  --ink:#05060a;
  --coal:#0a0c12;

  /* Shadow Fight vibe: âmbar, osso, fuligem */
  --ember: rgba(214, 160, 78, .95);
  --ember2: rgba(214, 160, 78, .18);
  --bone: rgba(245,240,230,.92);
  --dim: rgba(245,240,230,.62);
  --line: rgba(245,240,230,.10);

  --fx-vig: .55;
  --blur-amount: 24px;

  --panel-bg: rgba(0,0,0,.62);
  --panel-brd: rgba(245,240,230,.12);

  --scroll-w: min(860px, calc(100vw - 56px));
  --scroll-h: min(520px, calc(100vh - 110px));
}

*{margin:0;padding:0;box-sizing:border-box;}
html,body{height:100%;}
body{
  background:var(--ink);
  overflow:hidden;
  color:var(--bone);
  font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
}

/* ================= VIDEO ================= */
#videoBlur{
  position:fixed;
  inset:-20%;
  width:140%;
  height:140%;
  object-fit:cover;
  filter: blur(var(--blur-amount)) brightness(.55) saturate(.95) contrast(1.06);
  transform: translateZ(0);
  z-index:-5;
}
#video{
  position:fixed;
  inset:0;
  width:100%;
  height:100%;
  object-fit:cover;
  z-index:-4;
  background:#000;
}

/* ================= FX ================= */
.scanlines{
  position:fixed; inset:0;
  pointer-events:none;
  z-index:3;
  opacity:.30;
  mix-blend-mode:overlay;
  background:repeating-linear-gradient(
    to bottom,
    rgba(255,255,255,0.02),
    rgba(255,255,255,0.02) 1px,
    transparent 1px,
    transparent 4px
  );
}

#cinemaFX{
  position:fixed; inset:0;
  pointer-events:none;
  z-index:4;
}
#cinemaFX::before{
  content:"";
  position:absolute; inset:-20%;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='180' height='180'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='.35'/%3E%3C/svg%3E");
  opacity:.05;
  mix-blend-mode:overlay;
  animation:grain 6s steps(10) infinite;
}
#cinemaFX::after{
  content:"";
  position:absolute; inset:0;
  background:
    radial-gradient(circle at 50% 50%, transparent 0 62%, rgba(0,0,0,var(--fx-vig)) 86%, rgba(0,0,0,.82) 100%);
  opacity:.60;
}
@keyframes grain{
  0%{transform:translate(0,0)}
  10%{transform:translate(-2%, -3%)}
  20%{transform:translate(-4%, 2%)}
  30%{transform:translate(3%, -2%)}
  40%{transform:translate(2%, 4%)}
  50%{transform:translate(-3%, 2%)}
  60%{transform:translate(4%, 0%)}
  70%{transform:translate(0%, 3%)}
  80%{transform:translate(-2%, -2%)}
  90%{transform:translate(3%, 1%)}
  100%{transform:translate(0,0)}
}

/* flash ritual */
#glitchFlash{
  position:fixed; inset:0;
  pointer-events:none;
  z-index:9;
  opacity:0;
  background:
    radial-gradient(circle at 50% 50%, rgba(214,160,78,.12), transparent 58%),
    repeating-linear-gradient(0deg, rgba(255,255,255,.04) 0 1px, transparent 1px 6px);
  mix-blend-mode:screen;
}
body.glitch-on #glitchFlash{ animation:glitchFlash .55s steps(6) 1; }
@keyframes glitchFlash{
  0%{opacity:0}
  15%{opacity:1; transform:translateX(6px)}
  35%{opacity:.25; transform:translateX(-8px)}
  60%{opacity:.9; transform:translateX(4px)}
  100%{opacity:0; transform:none}
}

/* ================= LOADING ================= */
#loadingScreen{
  position:fixed; inset:0;
  z-index:10;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  background:radial-gradient(circle at center,#0a0c12,#000);
  transition:opacity .6s ease;
}
.loading-text{
  font-family:Cinzel, serif;
  letter-spacing:6px;
  font-size:11px;
  opacity:.86;
  text-align:center;
  margin-bottom:18px;
  animation:flicker 2.2s infinite;
}
@keyframes flicker{0%,100%{opacity:.76}50%{opacity:1}}
.spinner{
  width:40px;height:40px;
  border:3px solid rgba(255,255,255,.08);
  border-top:3px solid rgba(214,160,78,.72);
  border-radius:50%;
  animation:spin 1s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg)}}

#enterBox{
  margin-top:28px;
  padding:16px 66px;
  border-radius:12px;
  background:rgba(0,0,0,.55);
  border:1px solid rgba(214,160,78,.30);
  backdrop-filter:blur(14px);
  letter-spacing:8px;
  font-weight:700;
  font-size:13px;
  color:rgba(245,240,230,.92);
  text-shadow:0 0 14px rgba(214,160,78,.12);
  opacity:0;
  pointer-events:none;
  transition:.35s ease;
  cursor:pointer;
  user-select:none;
  font-family:Cinzel, serif;
}
#enterBox.show{opacity:1; pointer-events:auto;}
#enterHint{
  margin-top:10px;
  font-size:9px;
  letter-spacing:4px;
  opacity:0;
  transition:.35s ease;
  color:rgba(245,240,230,.72);
  user-select:none;
  font-family:Cinzel, serif;
}
#enterHint.show{opacity:.88;}

#versionTag{
  position:fixed;
  right:18px; bottom:12px;
  z-index:6;
  font-size:9px;
  letter-spacing:3px;
  opacity:.34;
  user-select:none;
  text-shadow:0 0 10px rgba(214,160,78,.08);
  font-family:Cinzel, serif;
}
#loadingScreen #versionTag{z-index:12;}

/* ================= TOP BAR (NORMAL SCREEN) ================= */
/* normal screen: somente Fullscreen + Pergaminho + Admin + Volume */
#topBar{
  position:fixed;
  top:14px;
  left:50%;
  transform:translateX(-50%);
  display:flex;
  gap:10px;
  z-index:25;
  opacity:.94;
  filter: drop-shadow(0 0 16px rgba(214,160,78,.10));
}
body:not(.entered) #topBar{ display:none; }

.topBtn{
  width:46px;height:38px;
  border-radius:14px;
  border:1px solid rgba(214,160,78,.22);
  background:
    radial-gradient(circle at 30% 30%, rgba(255,255,255,.06), transparent 60%),
    linear-gradient(180deg, rgba(0,0,0,.62), rgba(0,0,0,.35));
  backdrop-filter: blur(14px);
  cursor:pointer;
  display:grid;
  place-items:center;
  box-shadow: 0 0 0 1px rgba(0,0,0,.35) inset, 0 14px 38px rgba(0,0,0,.40);
  position:relative;
  overflow:hidden;
  color:var(--bone);
}
.topBtn::after{
  content:"";
  position:absolute; inset:-40% -30%;
  background:linear-gradient(90deg, transparent, rgba(214,160,78,.10), transparent);
  transform:rotate(14deg) translateX(-90%);
  opacity:0;
}
#topBar:hover .topBtn::after{
  opacity:1;
  animation:scanPass 1.15s ease infinite;
}
@keyframes scanPass{
  0%{transform:rotate(14deg) translateX(-90%);}
  100%{transform:rotate(14deg) translateX(90%);}
}
.topBtn:hover{ transform:translateY(-1px); }
.topBtn:active{ transform:translateY(1px); }
.topBtn svg{ width:18px;height:18px; opacity:.92; filter:drop-shadow(0 0 10px rgba(214,160,78,.10)); }

/* ================= VOLUME (SUPERIOR ESQUERDO) ================= */
#volumeHUD{
  position:fixed;
  top:14px;
  left:14px;
  z-index:26;
  display:flex;
  align-items:flex-start;
  gap:10px;
  opacity:.92;
  filter: drop-shadow(0 0 14px rgba(214,160,78,.10));
}
body:not(.entered) #volumeHUD{ display:none; }

.volBtn{
  width:44px;height:44px;
  border-radius:14px;
  border:1px solid rgba(214,160,78,.22);
  background:
    radial-gradient(circle at 30% 30%, rgba(255,255,255,.06), transparent 60%),
    linear-gradient(180deg, rgba(0,0,0,.62), rgba(0,0,0,.35));
  backdrop-filter: blur(14px);
  cursor:pointer;
  display:grid;
  place-items:center;
  box-shadow: 0 0 0 1px rgba(0,0,0,.35) inset, 0 14px 38px rgba(0,0,0,.40);
  position:relative;
  overflow:hidden;
}
.volBtn svg{ width:20px;height:20px; opacity:.92; filter:drop-shadow(0 0 10px rgba(214,160,78,.10)); }

.volPanel{
  width:0;
  opacity:0;
  pointer-events:none;
  transform:translateY(2px);
  transition:.22s ease;
  padding:10px 0;
  border-radius:14px;
  border:1px solid rgba(214,160,78,.16);
  background:rgba(0,0,0,.55);
  backdrop-filter: blur(14px);
  box-shadow: 0 12px 44px rgba(0,0,0,.50);
  overflow:hidden;
  font-family:Cinzel, serif;
}
#volumeHUD.open .volPanel{
  width:240px;
  opacity:1;
  pointer-events:auto;
  padding:10px 12px;
}
.volTop{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px;}
.volTitle{font-size:9px;letter-spacing:3px;opacity:.72;}
.volRead{font-size:10px;letter-spacing:2px;color:var(--bone);}

#volSlider{
  width:100%;
  height:26px;
  background:transparent;
  appearance:none;
  -webkit-appearance:none;
  cursor:pointer;
}
#volSlider::-webkit-slider-runnable-track{
  height:6px;border-radius:999px;
  background: linear-gradient(90deg, rgba(245,240,230,.75), rgba(214,160,78,.20));
  border:1px solid rgba(214,160,78,.14);
}
#volSlider::-webkit-slider-thumb{
  -webkit-appearance:none;
  width:16px;height:16px;border-radius:7px;
  margin-top:-6px;
  background: radial-gradient(circle at 30% 30%, rgba(245,240,230,1), rgba(214,160,78,.35));
  border:1px solid rgba(214,160,78,.22);
  box-shadow:0 0 14px rgba(214,160,78,.10);
}
#volSlider::-moz-range-track{
  height:6px;border-radius:999px;
  background: linear-gradient(90deg, rgba(245,240,230,.75), rgba(214,160,78,.20));
  border:1px solid rgba(214,160,78,.14);
}
#volSlider::-moz-range-thumb{
  width:16px;height:16px;border-radius:7px;
  background: radial-gradient(circle at 30% 30%, rgba(245,240,230,1), rgba(214,160,78,.35));
  border:1px solid rgba(214,160,78,.22);
}

/* ================= SELOS (menu único para discord/arquivos/etc) ================= */
#sealsPill{
  position:fixed;
  top:14px;
  right:14px;
  z-index:26;
  opacity:.94;
  filter: drop-shadow(0 0 14px rgba(214,160,78,.10));
}
body:not(.entered) #sealsPill{ display:none; }

.pillBtn{
  height:40px;
  padding:0 12px;
  border-radius:999px;
  border:1px solid rgba(214,160,78,.20);
  background:rgba(0,0,0,.55);
  backdrop-filter: blur(14px);
  cursor:pointer;
  display:flex;
  align-items:center;
  gap:8px;
  color:var(--bone);
  letter-spacing:4px;
  font-size:9px;
  box-shadow: 0 0 0 1px rgba(255,255,255,.03) inset, 0 12px 34px rgba(0,0,0,.28);
  font-family:Cinzel, serif;
}
.pillBtn svg{width:18px;height:18px;opacity:.92;filter:drop-shadow(0 0 10px rgba(214,160,78,.10));}

#sealsMenu{
  position:fixed;
  top:58px;
  right:14px;
  z-index:40;
  display:none;
}
#sealsMenu.show{ display:block; }

.sealsBox{
  width:260px;
  border-radius:16px;
  border:1px solid rgba(214,160,78,.16);
  background:rgba(0,0,0,.62);
  backdrop-filter: blur(14px);
  box-shadow:0 18px 66px rgba(0,0,0,.62);
  overflow:hidden;
  font-family:Cinzel, serif;
}
.sealsHead{
  padding:12px 12px;
  border-bottom:1px solid rgba(255,255,255,.06);
  letter-spacing:4px;
  font-size:10px;
  opacity:.88;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.sealsBody{ padding:10px; display:flex; flex-direction:column; gap:10px; }
.sealLink{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  padding:12px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.06);
  background:rgba(0,0,0,.25);
  text-decoration:none;
  color:var(--bone);
}
.sealLink:hover{
  border-color: rgba(214,160,78,.18);
  box-shadow:0 0 22px rgba(214,160,78,.06);
}
.sealLink .k{ letter-spacing:3px; font-size:10px; opacity:.92; }
.sealLink .s{ letter-spacing:3px; font-size:9px; opacity:.55; }

/* ================= PERGAMINHO (TERMINAL) ================= */
#scrollOverlay{
  position:fixed; inset:0;
  z-index:60;
  display:none;
  background: rgba(0,0,0,.55);
  backdrop-filter: blur(10px);
}
#scrollOverlay.show{ display:block; }

.scrollWrap{
  position:absolute;
  left:50%;
  top:50%;
  transform:translate(-50%,-50%) scale(.92);
  width:var(--scroll-w);
  height:var(--scroll-h);
  border-radius:22px;
  opacity:0;
  transition:.28s ease;
  filter: drop-shadow(0 30px 90px rgba(0,0,0,.75));
}
#scrollOverlay.show .scrollWrap{
  opacity:1;
  transform:translate(-50%,-50%) scale(1);
}

/* “pergaminho” com bordas e hastes laterais */
.scrollBody{
  position:absolute;
  inset:0;
  border-radius:22px;
  background:
    radial-gradient(circle at 40% 20%, rgba(255,255,255,.10), transparent 55%),
    linear-gradient(180deg, rgba(45,28,15,.92), rgba(16,10,7,.96));
  border:1px solid rgba(214,160,78,.20);
  overflow:hidden;
}
.scrollBody::before{
  content:"";
  position:absolute; inset:0;
  background:
    radial-gradient(circle at 50% 20%, rgba(214,160,78,.14), transparent 60%),
    repeating-linear-gradient(0deg, rgba(255,255,255,.04) 0 1px, transparent 1px 6px);
  opacity:.40;
  pointer-events:none;
}

/* hastes */
.scrollRodL, .scrollRodR{
  position:absolute;
  top:16px; bottom:16px;
  width:18px;
  border-radius:999px;
  background: linear-gradient(180deg, rgba(0,0,0,.18), rgba(255,255,255,.05), rgba(0,0,0,.18));
  border:1px solid rgba(214,160,78,.18);
  opacity:.85;
}
.scrollRodL{ left:14px; }
.scrollRodR{ right:14px; }

/* animação de “abrir” (desenrola) */
.scrollCurtain{
  position:absolute;
  inset:0;
  transform-origin: top;
  background: linear-gradient(180deg, rgba(0,0,0,.92), rgba(0,0,0,.25));
  animation: none;
  pointer-events:none;
}
#scrollOverlay.opening .scrollCurtain{
  animation: unroll .55s ease forwards;
}
@keyframes unroll{
  0%{transform:scaleY(1); opacity:1;}
  100%{transform:scaleY(0); opacity:0;}
}

/* header do pergaminho */
.scrollHeader{
  position:absolute;
  left:0; right:0; top:0;
  padding:14px 22px 12px 22px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-family:Cinzel, serif;
  letter-spacing:4px;
  font-size:10px;
  opacity:.92;
  border-bottom:1px solid rgba(255,255,255,.06);
  z-index:2;
}
.scrollHeader .dim{opacity:.55;}
.scrollClose{
  border:none;
  background:transparent;
  color:var(--bone);
  letter-spacing:4px;
  font-size:10px;
  cursor:pointer;
  opacity:.75;
}
.scrollClose:hover{opacity:1;}

/* conteúdo do terminal no pergaminho */
.scrollContent{
  position:absolute;
  left:26px; right:26px;
  top:58px; bottom:18px;
  padding:14px 18px;
  border-radius:16px;
  border:1px solid rgba(214,160,78,.14);
  background: rgba(0,0,0,.22);
  overflow:auto;
  z-index:2;
}

/* log */
#scrollLog{
  font-size:12px;
  line-height:1.7;
  letter-spacing:.3px;
  opacity:.95;
}
#scrollLog .dim{opacity:.60}

/* input */
.scrollInputRow{
  margin-top:12px;
  display:flex;
  gap:10px;
  align-items:center;
  border-top:1px solid rgba(255,255,255,.06);
  padding-top:12px;
}
.scrollPrompt{
  white-space:nowrap;
  font-family:Cinzel, serif;
  letter-spacing:3px;
  font-size:10px;
  opacity:.80;
}
#scrollInput{
  flex:1;
  height:38px;
  border-radius:12px;
  border:1px solid rgba(214,160,78,.14);
  background:rgba(0,0,0,.35);
  color:var(--bone);
  padding:0 12px;
  outline:none;
  font-family:Inter, system-ui, sans-serif;
  font-size:13px;
}
#scrollInput::placeholder{ color: rgba(245,240,230,.40); }

/* ================= ADMIN ================= */
#adminOverlay{
  position:fixed; inset:0;
  z-index:55;
  display:none;
  background: rgba(0,0,0,.55);
  backdrop-filter: blur(10px);
}
#adminOverlay.show{ display:block; }

.adminBox{
  position:absolute;
  left:50%;
  top:50%;
  transform:translate(-50%,-50%);
  width:min(720px, calc(100vw - 56px));
  border-radius:18px;
  border:1px solid rgba(214,160,78,.16);
  background: rgba(0,0,0,.62);
  box-shadow:0 24px 92px rgba(0,0,0,.72);
  overflow:hidden;
}
.adminHead{
  padding:12px 14px;
  border-bottom:1px solid rgba(255,255,255,.06);
  display:flex;
  justify-content:space-between;
  font-family:Cinzel, serif;
  letter-spacing:4px;
  font-size:10px;
  opacity:.90;
}
.adminBody{ padding:14px; }
.adminField{
  border-radius:14px;
  border:1px solid rgba(255,255,255,.06);
  background: rgba(0,0,0,.24);
  padding:12px;
}
.adminLabel{
  font-family:Cinzel, serif;
  letter-spacing:3px;
  font-size:9px;
  opacity:.58;
  margin-bottom:8px;
}
.adminInput{
  width:100%;
  height:42px;
  border-radius:12px;
  border:1px solid rgba(214,160,78,.14);
  background:rgba(0,0,0,.35);
  color:var(--bone);
  padding:0 12px;
  outline:none;
  font-family:Inter, system-ui, sans-serif;
  font-size:13px;
}
.adminActions{
  margin-top:12px;
  display:flex;
  align-items:center;
  gap:10px;
  flex-wrap:wrap;
}
.aBtn{
  height:34px;
  padding:0 14px;
  border-radius:12px;
  border:1px solid rgba(214,160,78,.18);
  background: rgba(0,0,0,.28);
  color:var(--bone);
  cursor:pointer;
  font-family:Cinzel, serif;
  letter-spacing:3px;
  font-size:10px;
}
.aBtn:hover{ box-shadow:0 0 22px rgba(214,160,78,.06); }
.aPill{
  font-family:Cinzel, serif;
  letter-spacing:2px;
  font-size:10px;
  padding:6px 10px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.08);
  background: rgba(0,0,0,.20);
  opacity:.86;
}
.aPill.ok{ border-color: rgba(214,160,78,.18); }
.aPill.bad{ border-color: rgba(255,120,120,.22); }

/* dashboard */
#adminDash{ display:none; }
#adminOverlay.dash #adminLogin{ display:none; }
#adminOverlay.dash #adminDash{ display:block; }
.statRow{
  display:grid;
  grid-template-columns:repeat(3, minmax(0,1fr));
  gap:10px;
  margin-top:12px;
}
@media (max-width: 760px){ .statRow{ grid-template-columns:1fr; } }
.statCard{
  border-radius:14px;
  border:1px solid rgba(255,255,255,.06);
  background: rgba(0,0,0,.22);
  padding:12px;
}
.statT{ font-family:Cinzel, serif; letter-spacing:3px; font-size:9px; opacity:.55; }
.statV{ margin-top:8px; font-family:Cinzel, serif; letter-spacing:2px; font-size:22px; opacity:.94; }
.statS{ margin-top:6px; opacity:.72; font-size:12px; letter-spacing:.3px; }

/* ================= REDUCED MOTION ================= */
@media (prefers-reduced-motion: reduce){
  #cinemaFX::before{animation:none}
  .spinner{animation:none}
}
</style>
</head>

<body>

<!-- VIDEO -->
<video id="videoBlur" playsinline preload="auto" muted loop>
  <source src="https://files.catbox.moe/klaol5.webm" type="video/webm" />
</video>

<video id="video" playsinline preload="auto" loop>
  <source src="https://files.catbox.moe/klaol5.webm" type="video/webm" />
</video>

<audio id="ambience" preload="auto" loop>
  <source src="https://files.catbox.moe/99fu05.m4a" type="audio/mp4">
</audio>

<div class="scanlines"></div>
<div id="cinemaFX"></div>
<div id="glitchFlash"></div>

<div id="versionTag"><span class="v">shadow temple interface: v2</span></div>

<!-- LOADING -->
<div id="loadingScreen">
  <div class="loading-text" id="dynamicText">O TEMPLO RESPIRA…</div>
  <div class="spinner" id="spinner"></div>
  <div id="enterBox">ENTRAR</div>
  <div id="enterHint">PRESSIONE [ENTER] PARA PROSSEGUIR</div>
</div>

<!-- TOP BAR (NORMAL) -->
<div id="topBar">
  <!-- Fullscreen -->
  <button class="topBtn" id="btnFS" title="Tela Cheia" aria-label="Tela cheia">
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path d="M8 3H5a2 2 0 0 0-2 2v3M16 3h3a2 2 0 0 1 2 2v3M8 21H5a2 2 0 0 1-2-2v-3M16 21h3a2 2 0 0 0 2-2v-3"
        fill="none" stroke="rgba(245,240,230,.88)" stroke-width="1.7" stroke-linecap="round"/>
    </svg>
  </button>

  <!-- Pergaminho terminal -->
  <button class="topBtn" id="btnScroll" title="Pergaminho" aria-label="Pergaminho">
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path d="M7 4h10v16H7a3 3 0 0 1 0-6h10"
        fill="none" stroke="rgba(245,240,230,.86)" stroke-width="1.7" stroke-linejoin="round"/>
      <path d="M10 9h5M10 12h5M10 15h4"
        fill="none" stroke="rgba(245,240,230,.70)" stroke-width="1.7" stroke-linecap="round"/>
    </svg>
  </button>

  <!-- Admin -->
  <button class="topBtn" id="btnAdmin" title="Câmara" aria-label="Admin">
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path d="M12 3c4.5 0 8 2.6 8 7.5 0 7-5.2 10.5-8 10.5S4 17.5 4 10.5C4 5.6 7.5 3 12 3Z"
        fill="none" stroke="rgba(245,240,230,.86)" stroke-width="1.6" stroke-linejoin="round"/>
      <path d="M9 10.5c.8-1.1 2-.9 3 0m3 0c.8-1.1 2-.9 3 0"
        fill="none" stroke="rgba(245,240,230,.68)" stroke-width="1.6" stroke-linecap="round"/>
    </svg>
  </button>
</div>

<!-- VOLUME -->
<div id="volumeHUD">
  <button class="volBtn" id="volBtn" type="button" aria-label="Volume">
    <!-- ícone “sino / selo” -->
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path d="M12 3.6c2.6 0 4.6 2 4.6 4.6v2.4c0 1.6.6 2.8 1.6 3.8l.7.7H5.1l.7-.7c1-1 1.6-2.2 1.6-3.8V8.2c0-2.6 2-4.6 4.6-4.6Z"
        fill="none" stroke="rgba(245,240,230,.86)" stroke-width="1.6" stroke-linejoin="round"/>
      <path d="M10 18.6c.4 1 1.1 1.6 2 1.6s1.6-.6 2-1.6"
        fill="none" stroke="rgba(245,240,230,.62)" stroke-width="1.6" stroke-linecap="round"/>
    </svg>
  </button>

  <div class="volPanel" id="volPanel">
    <div class="volTop">
      <div class="volTitle">ECO // MIX</div>
      <div class="volRead" id="volRead">45%</div>
    </div>
    <input type="range" id="volSlider" min="0" max="1" step="0.01" value="0.45" />
  </div>
</div>

<!-- SELOS -->
<div id="sealsPill">
  <button class="pillBtn" id="btnSeals" type="button" aria-label="Selos">
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path d="M12 3.7 19 8v8l-7 4.3L5 16V8l7-4.3Z" fill="none" stroke="rgba(245,240,230,.84)" stroke-width="1.6" stroke-linejoin="round"/>
      <path d="M12 7v10" fill="none" stroke="rgba(245,240,230,.60)" stroke-width="1.6" stroke-linecap="round"/>
    </svg>
    <span>SELOS</span>
  </button>
</div>

<div id="sealsMenu" aria-hidden="true">
  <div class="sealsBox">
    <div class="sealsHead">
      <div>SELOS // PORTAS</div>
      <div style="opacity:.55">ESC</div>
    </div>
    <div class="sealsBody">
      <a class="sealLink" id="sealDiscord" href="https://discord.gg/example" target="_blank" rel="noopener noreferrer">
        <span class="k">DISCORD</span><span class="s">ENTRAR</span>
      </a>
      <a class="sealLink" id="sealInstagram" href="https://instagram.com/example" target="_blank" rel="noopener noreferrer">
        <span class="k">INSTAGRAM</span><span class="s">ABRIR</span>
      </a>
      <a class="sealLink" id="sealFiles" href="#" onclick="return false;">
        <span class="k">ARQUIVOS</span><span class="s">EM BREVE</span>
      </a>
    </div>
  </div>
</div>

<!-- PERGAMINHO -->
<div id="scrollOverlay" aria-hidden="true">
  <div class="scrollWrap">
    <div class="scrollBody">
      <div class="scrollRodL"></div>
      <div class="scrollRodR"></div>

      <div class="scrollHeader">
        <div>PERGAMINHO // JURAMENTO</div>
        <button class="scrollClose" id="scrollCloseBtn" type="button">FECHAR</button>
      </div>

      <div class="scrollContent">
        <div id="scrollLog">
          <div class="dim">O pergaminho aguarda um comando…</div>
        </div>

        <div class="scrollInputRow">
          <div class="scrollPrompt">sombra@templo:~$</div>
          <input id="scrollInput" type="text" autocomplete="off" spellcheck="false" placeholder="Digite: help" />
        </div>
      </div>

      <div class="scrollCurtain"></div>
    </div>
  </div>
</div>

<!-- ADMIN -->
<div id="adminOverlay" aria-hidden="true">
  <div class="adminBox">
    <div class="adminHead">
      <div>CÂMARA // ACESSO RESTRITO</div>
      <div style="opacity:.55">ESC</div>
    </div>

    <div class="adminBody">
      <div id="adminLogin">
        <div class="adminField">
          <div class="adminLabel">SENHA</div>
          <input id="adminPass" class="adminInput" type="password" autocomplete="off" spellcheck="false" placeholder="••••••••" />
        </div>

        <div class="adminActions">
          <button class="aBtn" id="adminAuth">ABRIR</button>
          <button class="aBtn" id="adminClear">LIMPAR</button>
          <div id="adminStatus" class="aPill">Aguardando…</div>
        </div>
      </div>

      <div id="adminDash">
        <div class="adminField">
          <div class="adminLabel">STATUS</div>
          <div style="font-family:Cinzel,serif;letter-spacing:2px;opacity:.9">DASH LIBERADO</div>
        </div>

        <div class="statRow">
          <div class="statCard">
            <div class="statT">ENTRADAS</div>
            <div class="statV" id="mViews">0</div>
            <div class="statS">local</div>
          </div>
          <div class="statCard">
            <div class="statT">DISPOSITIVO</div>
            <div class="statV" id="mUnique">0</div>
            <div class="statS">local</div>
          </div>
          <div class="statCard">
            <div class="statT">ÚLTIMO RITO</div>
            <div class="statV" style="font-size:14px" id="mLast">—</div>
            <div class="statS">timestamp</div>
          </div>
        </div>

        <div class="adminActions">
          <button class="aBtn" id="adminReset">ZERAR</button>
          <button class="aBtn" id="adminLock">SELAR</button>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
/* ===============================
   SHADOW TEMPLE // v2 (CORE)
   Parte 2/4: Enter + Media + HUD + Menus
================================ */

/* ===== Elements ===== */
const video = document.getElementById("video");
const videoBlur = document.getElementById("videoBlur");
const ambience = document.getElementById("ambience");

/* Loading / Enter */
const loadingScreen = document.getElementById("loadingScreen");
const dynamicText = document.getElementById("dynamicText");
const spinner = document.getElementById("spinner");
const enterBox = document.getElementById("enterBox");
const enterHint = document.getElementById("enterHint");

/* Top UI */
const topBar = document.getElementById("topBar");
const btnFS = document.getElementById("btnFS");
const btnScroll = document.getElementById("btnScroll");
const btnAdmin = document.getElementById("btnAdmin");

/* Volume */
const volumeHUD = document.getElementById("volumeHUD");
const volBtn = document.getElementById("volBtn");
const volPanel = document.getElementById("volPanel");
const volSlider = document.getElementById("volSlider");
const volRead = document.getElementById("volRead");

/* SELOS */
const btnSeals = document.getElementById("btnSeals");
const sealsMenu = document.getElementById("sealsMenu");

/* Pergaminho */
const scrollOverlay = document.getElementById("scrollOverlay");
const scrollCloseBtn = document.getElementById("scrollCloseBtn");
const scrollLog = document.getElementById("scrollLog");
const scrollInput = document.getElementById("scrollInput");

/* Admin */
const adminOverlay = document.getElementById("adminOverlay");
const adminPass = document.getElementById("adminPass");
const adminAuth = document.getElementById("adminAuth");
const adminClear = document.getElementById("adminClear");
const adminStatus = document.getElementById("adminStatus");
const adminReset = document.getElementById("adminReset");
const adminLock = document.getElementById("adminLock");
const mViews = document.getElementById("mViews");
const mUnique = document.getElementById("mUnique");
const mLast = document.getElementById("mLast");

/* FX */
const glitchFlash = document.getElementById("glitchFlash");

/* ===== State ===== */
let hasEntered = false;
let allowPlay = false;         // só libera play após entrar
let ambOn = true;              // ambience on/off
let scrollOpen = false;
let adminOpen = false;

/* ===== Helpers ===== */
function $(s){ return document.querySelector(s); }
function nowStamp(){
  const d = new Date();
  const pad = (n)=>String(n).padStart(2,"0");
  return `${pad(d.getDate())}/${pad(d.getMonth()+1)} ${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}`;
}

/* ===== Glitch Flash ===== */
function triggerGlitch(){
  document.body.classList.remove("glitch-on");
  void document.body.offsetWidth;
  document.body.classList.add("glitch-on");
  setTimeout(()=>document.body.classList.remove("glitch-on"), 650);
}

/* ===== Loading text loop ===== */
const messages = [
  "O TEMPLO RESPIRA…",
  "A SOMBRA OBSERVA…",
  "SELOS SE FECHAM…",
  "A ARENA CHAMA…",
  "FERRO, DISCIPLINA…",
  "UM PASSO E NÃO VOLTA…"
];
let msgIndex = 0;
const msgTimer = setInterval(() => {
  if (!loadingScreen || loadingScreen.style.display === "none") return;
  msgIndex = (msgIndex + 1) % messages.length;
  dynamicText.textContent = messages[msgIndex];
}, 2200);

/* ===== Hard stop (evita vídeo tocando sozinho ao voltar) ===== */
function hardStopMedia(){
  try{ video.pause(); video.currentTime = 0; }catch(e){}
  try{ videoBlur.pause(); videoBlur.currentTime = 0; }catch(e){}
  try{ ambience.pause(); ambience.currentTime = 0; }catch(e){}
}
document.addEventListener("DOMContentLoaded", () => {
  // sempre começa parado
  hardStopMedia();
});
window.addEventListener("pageshow", () => {
  if (!hasEntered) hardStopMedia();
});

/* ===== Safe play ===== */
async function safePlayMedia(){
  if (!allowPlay) return;
  try{ await video.play(); }catch(e){}
  try{ await videoBlur.play(); }catch(e){}
  if (ambOn){
    try{ await ambience.play(); }catch(e){}
  }
}

/* ===== Visibility (travou? pausa em background) ===== */
document.addEventListener("visibilitychange", () => {
  if (document.hidden){
    try{ video.pause(); }catch(e){}
    try{ videoBlur.pause(); }catch(e){}
    try{ ambience.pause(); }catch(e){}
    return;
  }
  if (hasEntered) safePlayMedia();
});

/* ===== Video blur sync ===== */
video.addEventListener("play", () => {
  if (!hasEntered) return;
  videoBlur.play().catch(()=>{});
});
video.addEventListener("pause", () => {
  try{ videoBlur.pause(); }catch(e){}
});

/* ===== Enter readiness ===== */
let readyToEnter = false;
function markReady(){
  if (readyToEnter) return;
  readyToEnter = true;
  spinner.style.display = "none";
  enterBox.classList.add("show");
  enterHint.classList.add("show");
}
const SAFETY_TIMEOUT_MS = 7000;
setTimeout(() => {
  // mesmo se o vídeo enrolar, libera entrada
  markReady();
}, SAFETY_TIMEOUT_MS);

video.addEventListener("loadeddata", markReady, { once:true });
video.addEventListener("canplay", markReady, { once:true });
video.addEventListener("error", () => {
  spinner.style.display = "none";
  dynamicText.textContent = "RUPTURA // FALHA NO VÉU";
  markReady();
}, { once:true });

/* ===== Metrics (local) ===== */
function getOrCreateUID(){
  let uid = localStorage.getItem("st_uid");
  if (!uid){
    uid = "uid_" + Math.random().toString(16).slice(2) + "_" + Date.now().toString(16);
    localStorage.setItem("st_uid", uid);
  }
  return uid;
}
function bumpMetrics(){
  const uid = getOrCreateUID();

  const views = Number(localStorage.getItem("st_views") || "0") + 1;
  localStorage.setItem("st_views", String(views));

  // unique por device é 1
  localStorage.setItem("st_unique", "1");
  localStorage.setItem("st_last", nowStamp());

  // (uid não exibido; fica lá pra futuro)
}
function renderMetrics(){
  mViews.textContent = localStorage.getItem("st_views") || "0";
  mUnique.textContent = localStorage.getItem("st_unique") || "0";
  mLast.textContent = localStorage.getItem("st_last") || "—";
}

/* ===== Enter action ===== */
async function doEnter(){
  if (hasEntered) return;
  hasEntered = true;
  allowPlay = true;

  bumpMetrics();

  // some loading
  loadingScreen.style.opacity = "0";
  setTimeout(() => { loadingScreen.style.display = "none"; }, 620);

  // libera UI normal
  document.body.classList.add("entered");

  // volume default 45%
  video.volume = 0.45;
  volSlider.value = "0.45";
  ambience.volume = Math.min(0.20, Math.max(0.03, video.volume * 0.35));
  updateVolumeUI();

  // toca
  await safePlayMedia();

  // ritualzinho
  triggerGlitch();
}
enterBox.addEventListener("click", doEnter);
document.addEventListener("keydown", (e) => {
  if (!hasEntered && e.key === "Enter"){
    doEnter();
  }
});

/* ===== Fullscreen ===== */
async function toggleFullscreen(){
  try{
    if (!document.fullscreenElement) await document.documentElement.requestFullscreen();
    else await document.exitFullscreen();
  }catch(e){}
}
btnFS.addEventListener("click", toggleFullscreen);

/* ===============================
   VOLUME (45% default + panel)
================================ */
function updateVolumeUI(){
  const pct = Math.round(video.volume * 100);
  volRead.textContent = pct + "%";
  ambience.volume = Math.min(0.20, Math.max(0.03, video.volume * 0.35));
}
volSlider.addEventListener("input", () => {
  video.volume = Number(volSlider.value);
  updateVolumeUI();
});

volBtn.addEventListener("click", (e) => {
  e.stopPropagation();
  volumeHUD.classList.toggle("open");
});
document.addEventListener("click", () => {
  volumeHUD.classList.remove("open");
});

/* ===============================
   SELOS MENU
================================ */
function closeSeals(){
  sealsMenu.classList.remove("show");
}
btnSeals.addEventListener("click", (e) => {
  e.stopPropagation();
  // fecha outros overlays
  closeScroll();
  closeAdmin();
  sealsMenu.classList.toggle("show");
});
sealsMenu.addEventListener("click", (e) => e.stopPropagation());
document.addEventListener("click", closeSeals);

/* ===============================
   PERGAMINHO (terminal)
================================ */
function logScroll(line, dim=false){
  const div = document.createElement("div");
  div.className = dim ? "dim" : "";
  div.textContent = line;
  scrollLog.appendChild(div);
  scrollLog.scrollTop = scrollLog.scrollHeight;
}

function openScroll(){
  if (scrollOpen) return;
  scrollOpen = true;

  closeSeals();
  closeAdmin();

  scrollOverlay.classList.add("show");
  scrollOverlay.classList.add("opening");
  setTimeout(()=>scrollOverlay.classList.remove("opening"), 650);

  // texto de impacto
  logScroll("—", true);
  logScroll("O PERGAMINHO DESENROLA…", true);
  logScroll("Digite: help  |  clear  |  glitch  |  mute", true);

  setTimeout(()=>scrollInput.focus(), 260);
}
function closeScroll(){
  if (!scrollOpen) return;
  scrollOpen = false;
  scrollOverlay.classList.remove("show");
}
btnScroll.addEventListener("click", openScroll);
scrollCloseBtn.addEventListener("click", closeScroll);
scrollOverlay.addEventListener("click", (e) => {
  // clique fora fecha
  if (e.target === scrollOverlay) closeScroll();
});

/* ===============================
   ADMIN
================================ */
const ADMIN_PASS = "Projeto26";

function openAdmin(){
  if (adminOpen) return;
  adminOpen = true;

  closeSeals();
  closeScroll();

  renderMetrics();
  adminOverlay.classList.add("show");
  setTimeout(()=>adminPass.focus(), 120);
}
function closeAdmin(){
  if (!adminOpen) return;
  adminOpen = false;
  adminOverlay.classList.remove("show");
  adminOverlay.classList.remove("dash");
  adminStatus.textContent = "Aguardando…";
  adminStatus.className = "aPill";
  adminPass.value = "";
}
btnAdmin.addEventListener("click", openAdmin);
adminOverlay.addEventListener("click", (e) => {
  if (e.target === adminOverlay) closeAdmin();
});

adminAuth.addEventListener("click", () => {
  const v = (adminPass.value || "").trim();
  if (v === ADMIN_PASS){
    adminOverlay.classList.add("dash");
    adminStatus.textContent = "LIBERADO";
    adminStatus.className = "aPill ok";
    renderMetrics();
    triggerGlitch();
  }else{
    adminStatus.textContent = "NEGADO";
    adminStatus.className = "aPill bad";
    triggerGlitch();
  }
});
adminClear.addEventListener("click", () => {
  adminPass.value = "";
  adminStatus.textContent = "Aguardando…";
  adminStatus.className = "aPill";
  adminPass.focus();
});
adminReset.addEventListener("click", () => {
  localStorage.setItem("st_views", "0");
  localStorage.setItem("st_unique", "1");
  localStorage.setItem("st_last", "—");
  renderMetrics();
  triggerGlitch();
});
adminLock.addEventListener("click", () => {
  closeAdmin();
  triggerGlitch();
});

/* ===============================
   SCROLL COMMANDS (mini console)
================================ */
function handleCommand(raw){
  const cmd = (raw || "").trim().toLowerCase();
  if (!cmd) return;

  logScroll(`sombra@templo:~$ ${raw}`, true);

  if (cmd === "help"){
    logScroll("COMANDOS:", true);
    logScroll("• help  — lista comandos", true);
    logScroll("• clear — limpa o pergaminho", true);
    logScroll("• glitch — ruptura", true);
    logScroll("• mute — alterna ECO (áudio)", true);
    logScroll("• vol 0-100 — define volume do vídeo", true);
    return;
  }

  if (cmd === "clear"){
    scrollLog.innerHTML = "";
    logScroll("SILÊNCIO NO PERGAMINHO…", true);
    return;
  }

  if (cmd === "glitch"){
    triggerGlitch();
    logScroll("RUPTURA EXECUTADA.", true);
    return;
  }

  if (cmd === "mute"){
    ambOn = !ambOn;
    if (!ambOn){
      try{ ambience.pause(); }catch(e){}
      logScroll("ECO: SELADO (mute).", true);
    }else{
      if (hasEntered) ambience.play().catch(()=>{});
      logScroll("ECO: LIBERADO.", true);
    }
    return;
  }

  if (cmd.startsWith("vol ")){
    const n = Number(cmd.replace("vol ","").trim());
    if (!Number.isFinite(n) || n < 0 || n > 100){
      logScroll("VALOR INVÁLIDO. Use: vol 0-100", true);
      return;
    }
    video.volume = n/100;
    volSlider.value = String(video.volume);
    updateVolumeUI();
    logScroll(`VOLUME DEFINIDO: ${n}%`, true);
    return;
  }

  logScroll("COMANDO DESCONHECIDO. Digite: help", true);
}

scrollInput.addEventListener("keydown", (e) => {
  if (e.key === "Enter"){
    const v = scrollInput.value;
    scrollInput.value = "";
    handleCommand(v);
  }
});

/* ===============================
   GLOBAL ESC (fecha overlays)
================================ */
document.addEventListener("keydown", (e) => {
  if (e.key !== "Escape") return;

  // ordem: scroll > admin > seals > volume
  if (scrollOpen){ closeScroll(); return; }
  if (adminOpen){ closeAdmin(); return; }
  if (sealsMenu.classList.contains("show")){ closeSeals(); return; }
  if (volumeHUD.classList.contains("open")){ volumeHUD.classList.remove("open"); return; }
});

/* ===============================
   SAFETY: evita travar / looping
================================ */
setInterval(() => {
  // mantém blur e vídeo alinhados se der algum “engasgo”
  if (!hasEntered) return;
  try{
    const diff = Math.abs((video.currentTime || 0) - (videoBlur.currentTime || 0));
    if (diff > 0.22){
      videoBlur.currentTime = video.currentTime;
    }
  }catch(e){}
}, 1200);

</script>
<!-- ===============================
     SELOS MENU (somente aqui ficam: Discord/Arquivos/etc)
================================ -->
<div id="sealsMenu" class="sealsMenu" aria-hidden="true">
  <div class="sealsBox" role="dialog" aria-label="Selos do Templo">
    <div class="sealsHead">
      <div class="sealsTitle">SELOS // PORTAS EXTERNAS</div>
      <button class="sealsClose" type="button" onclick="document.getElementById('sealsMenu').classList.remove('show')">FECHAR</button>
    </div>

    <div class="sealsGrid">
      <!-- SOCIAL -->
      <a class="sealCard" href="https://discord.gg/example" target="_blank" rel="noopener noreferrer">
        <div class="sealIcon" aria-hidden="true">
          <!-- máscara/warrior -->
          <svg viewBox="0 0 24 24">
            <path d="M12 3c4.8 0 8.5 2.8 8.5 7.8 0 7.2-5.6 10.2-8.5 10.2S3.5 18 3.5 10.8C3.5 5.8 7.2 3 12 3Z"
              fill="none" stroke="rgba(245,248,255,.90)" stroke-width="1.8" stroke-linejoin="round"/>
            <path d="M8.5 10.8c.9-1.2 2.2-1 3.3 0m3.4 0c.9-1.2 2.2-1 3.3 0"
              fill="none" stroke="rgba(245,248,255,.65)" stroke-width="1.8" stroke-linecap="round"/>
            <path d="M9.3 15.2c1.1.9 2.3 1 2.7 1s1.6-.1 2.7-1"
              fill="none" stroke="rgba(245,248,255,.58)" stroke-width="1.8" stroke-linecap="round"/>
          </svg>
        </div>
        <div class="sealTxt">
          <div class="sealName">DISCORD</div>
          <div class="sealSub">ARENA // VOZ & CLÃ</div>
        </div>
        <div class="sealAct">ABRIR</div>
      </a>

      <a class="sealCard" href="https://instagram.com/example" target="_blank" rel="noopener noreferrer">
        <div class="sealIcon" aria-hidden="true">
          <!-- “selo” circular -->
          <svg viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="8.2" fill="none" stroke="rgba(245,248,255,.86)" stroke-width="1.8"/>
            <path d="M12 7.2v9.6M7.2 12h9.6" fill="none" stroke="rgba(245,248,255,.60)" stroke-width="1.8" stroke-linecap="round"/>
            <path d="M12 3.2v2.2M12 18.6v2.2M3.2 12h2.2M18.6 12h2.2" fill="none" stroke="rgba(245,248,255,.46)" stroke-width="1.6" stroke-linecap="round"/>
          </svg>
        </div>
        <div class="sealTxt">
          <div class="sealName">INSTAGRAM</div>
          <div class="sealSub">ARQUIVO // IMAGEM</div>
        </div>
        <div class="sealAct">ABRIR</div>
      </a>

      <!-- ARQUIVOS / PASTA -->
      <a class="sealCard" href="#" onclick="return false;">
        <div class="sealIcon" aria-hidden="true">
          <!-- caixa/baú -->
          <svg viewBox="0 0 24 24">
            <path d="M6 7h12v4H6V7Z" fill="none" stroke="rgba(245,248,255,.88)" stroke-width="1.8" stroke-linejoin="round"/>
            <path d="M7 11v9h10v-9" fill="none" stroke="rgba(245,248,255,.62)" stroke-width="1.8" stroke-linejoin="round"/>
            <path d="M10 15h4" fill="none" stroke="rgba(245,248,255,.58)" stroke-width="1.8" stroke-linecap="round"/>
          </svg>
        </div>
        <div class="sealTxt">
          <div class="sealName">ARQUIVOS</div>
          <div class="sealSub">EM BREVE // PASTA</div>
        </div>
        <div class="sealAct">SELADO</div>
      </a>

      <!-- HUB / ARENA -->
      <a class="sealCard" href="#" onclick="return false;">
        <div class="sealIcon" aria-hidden="true">
          <!-- lâmina -->
          <svg viewBox="0 0 24 24">
            <path d="M4 20l6-2 10-10-4-4L6 14l-2 6Z" fill="none" stroke="rgba(245,248,255,.88)" stroke-width="1.8" stroke-linejoin="round"/>
            <path d="M14 6l4 4" fill="none" stroke="rgba(245,248,255,.58)" stroke-width="1.8" stroke-linecap="round"/>
          </svg>
        </div>
        <div class="sealTxt">
          <div class="sealName">ARENA</div>
          <div class="sealSub">HUB // JOGOS</div>
        </div>
        <div class="sealAct">BREVE</div>
      </a>
    </div>

    <div class="sealsFoot">
      <div class="sealsHint">ATALHOS: <b>S</b> Selos • <b>G</b> Pergaminho • <b>A</b> Admin • <b>F</b> Fullscreen • <b>ESC</b> Fechar</div>
    </div>
  </div>
</div>

<!-- ===============================
     PATCH: Upgrades do Pergaminho (conteúdo mais “Shadow Fight”)
================================ -->
<script>
/* Parte 3: reforço brutal do pergaminho + atalhos */
(function(){
  const scrollLog = document.getElementById("scrollLog");
  const scrollInput = document.getElementById("scrollInput");
  const scrollOverlay = document.getElementById("scrollOverlay");
  const sealsMenu = document.getElementById("sealsMenu");

  // se o user abrir o pergaminho, dá texto mais forte (só uma vez)
  let introInjected = false;

  function injectIntro(){
    if (introInjected) return;
    introInjected = true;

    const lines = [
      "—",
      "NO INÍCIO, O TEMPLO RESPIRAVA EM SILÊNCIO.",
      "A SOMBRA CAMINHAVA SEM ROSTO, SEM NOME, SEM LUZ.",
      "O PORTAL TREMEU. O SELO RACHOU.",
      "A ARENA PEDIA SANGUE, FERRO E DISCIPLINA.",
      "SE VOCÊ ABRIR ISTO, NÃO VOLTA IGUAL.",
      "Σ Δ Ψ // JURAMENTO DO SOMBRA",
      "—",
      "Digite: help  |  clear  |  glitch  |  mute  |  vol 0-100",
    ];
    for (const l of lines){
      const div = document.createElement("div");
      div.textContent = l;
      div.className = (l === "—") ? "dim" : "";
      scrollLog.appendChild(div);
    }
    scrollLog.scrollTop = scrollLog.scrollHeight;
  }

  // Observa quando abrir (classe show)
  const obs = new MutationObserver(() => {
    if (scrollOverlay.classList.contains("show")){
      injectIntro();
      setTimeout(()=>scrollInput && scrollInput.focus(), 200);
    }
  });
  obs.observe(scrollOverlay, { attributes:true, attributeFilter:["class"] });

  /* ===== Atalhos (Shadow Fight vibe) =====
     S = selos
     G = pergaminho
     A = admin
     F = fullscreen
  */
  document.addEventListener("keydown", (e) => {
    // não rouba quando digitando
    const tag = (document.activeElement && document.activeElement.tagName || "").toLowerCase();
    const typing = tag === "input" || tag === "textarea";

    if (typing) return;

    if (e.key.toLowerCase() === "s"){
      e.preventDefault();
      // toggle selos
      if (sealsMenu.classList.contains("show")) sealsMenu.classList.remove("show");
      else{
        // fecha pergaminho/admin pelo core (se existir)
        try{ window.closeScroll && window.closeScroll(); }catch(_){}
        try{ window.closeAdmin && window.closeAdmin(); }catch(_){}
        sealsMenu.classList.add("show");
      }
      try{ window.triggerGlitch && window.triggerGlitch(); }catch(_){}
    }

    if (e.key.toLowerCase() === "g"){
      e.preventDefault();
      try{ window.openScroll && window.openScroll(); }catch(_){}
      try{ window.triggerGlitch && window.triggerGlitch(); }catch(_){}
    }

    if (e.key.toLowerCase() === "a"){
      e.preventDefault();
      try{ window.openAdmin && window.openAdmin(); }catch(_){}
      try{ window.triggerGlitch && window.triggerGlitch(); }catch(_){}
    }

    if (e.key.toLowerCase() === "f"){
      e.preventDefault();
      try{ window.toggleFullscreen && window.toggleFullscreen(); }catch(_){}
    }
  });

})();
</script>

<!-- ===============================
     CSS EXTRA (SELOS + “BRUTAL”)
     (coloque esse <style> NO FINAL do seu CSS, se preferir. Pode ficar aqui também.)
================================ -->
<style>
/* SELOS menu — menos “tech”, mais “templo/arena” */
.sealsMenu{
  position:fixed; inset:0;
  z-index:40;
  display:none;
  background: rgba(0,0,0,.72);
  backdrop-filter: blur(14px);
}
.sealsMenu.show{ display:block; }

.sealsBox{
  position:absolute;
  right:18px; top:62px;
  width:min(520px, calc(100vw - 36px));
  border-radius:18px;
  border:1px solid rgba(255,255,255,.10);
  background:
    radial-gradient(circle at 20% 15%, rgba(120,170,255,.10), transparent 55%),
    linear-gradient(180deg, rgba(12,10,8,.78), rgba(0,0,0,.64));
  box-shadow: 0 28px 110px rgba(0,0,0,.78);
  overflow:hidden;
}

.sealsHead{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:12px 12px;
  border-bottom:1px solid rgba(255,255,255,.08);
}
.sealsTitle{
  font-family: Cinzel, serif;
  font-size:11px;
  letter-spacing:4px;
  opacity:.92;
}
.sealsClose{
  height:32px;
  padding:0 12px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.10);
  background: rgba(0,0,0,.26);
  color: rgba(245,248,255,.90);
  font-family: Cinzel, serif;
  letter-spacing:3px;
  font-size:9px;
  cursor:pointer;
}
.sealsClose:hover{
  box-shadow: 0 0 24px rgba(120,170,255,.10);
  transform: translateY(-1px);
}

.sealsGrid{
  display:grid;
  grid-template-columns:1fr;
  gap:10px;
  padding:12px;
}
.sealCard{
  display:grid;
  grid-template-columns:56px 1fr 70px;
  align-items:center;
  gap:10px;
  padding:12px 12px;
  border-radius:16px;
  text-decoration:none;
  color:inherit;
  border:1px solid rgba(255,255,255,.08);
  background:
    radial-gradient(circle at 18% 30%, rgba(255,255,255,.05), transparent 55%),
    linear-gradient(180deg, rgba(0,0,0,.20), rgba(0,0,0,.34));
  box-shadow: 0 0 0 1px rgba(0,0,0,.30) inset;
  position:relative;
  overflow:hidden;
}
.sealCard::before{
  content:"";
  position:absolute;
  inset:-40% -30%;
  background: linear-gradient(90deg, transparent, rgba(120,170,255,.10), transparent);
  transform: rotate(12deg) translateX(-90%);
  opacity:0;
}
.sealCard:hover::before{
  opacity:1;
  animation: sealScan 1.05s ease infinite;
}
@keyframes sealScan{
  0%{transform: rotate(12deg) translateX(-90%);}
  100%{transform: rotate(12deg) translateX(90%);}
}
.sealCard:hover{
  border-color: rgba(120,170,255,.22);
  box-shadow: 0 0 0 1px rgba(0,0,0,.30) inset, 0 0 34px rgba(120,170,255,.12);
  transform: translateY(-1px);
}

.sealIcon{
  width:56px;height:56px;
  border-radius:16px;
  display:grid;
  place-items:center;
  border:1px solid rgba(120,170,255,.16);
  background:
    radial-gradient(circle at 30% 30%, rgba(255,255,255,.07), transparent 60%),
    linear-gradient(180deg, rgba(0,0,0,.18), rgba(0,0,0,.32));
  box-shadow: 0 0 0 1px rgba(0,0,0,.35) inset;
}
.sealIcon svg{
  width:22px; height:22px;
  filter: drop-shadow(0 0 10px rgba(120,170,255,.10));
  opacity:.95;
}

.sealTxt{ min-width:0; }
.sealName{
  font-family: Cinzel, serif;
  font-size:13px;
  letter-spacing:2px;
  opacity:.95;
}
.sealSub{
  margin-top:4px;
  font-family: Cinzel, serif;
  font-size:9px;
  letter-spacing:3px;
  opacity:.55;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
.sealAct{
  justify-self:end;
  font-family: Cinzel, serif;
  font-size:9px;
  letter-spacing:3px;
  opacity:.78;
  padding:7px 10px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.10);
  background: rgba(0,0,0,.22);
}

.sealsFoot{
  padding:10px 12px 12px 12px;
  border-top:1px solid rgba(255,255,255,.08);
  background: linear-gradient(180deg, rgba(0,0,0,.00), rgba(0,0,0,.20));
}
.sealsHint{
  font-family: Cinzel, serif;
  font-size:9px;
  letter-spacing:2px;
  opacity:.62;
}
.sealsHint b{
  opacity:.95;
  text-shadow: 0 0 12px rgba(120,170,255,.10);
}

/* Pergaminho: deixa mais “papel” e menos “vidro” (sem mexer no core) */
.scrollPanel{
  box-shadow:
    0 30px 130px rgba(0,0,0,.82),
    0 0 0 1px rgba(0,0,0,.35) inset;
}
.scrollLog{
  text-shadow: 0 0 14px rgba(0,0,0,.18);
}

/* micro efeito “tinta queimando” quando abre */
#scrollOverlay.opening .scrollPanel{
  filter: contrast(1.08) saturate(.95);
}
</style>
<!-- ===============================
     PATCH FINAL (JS CORE + FIXES)
================================ -->
<script>
/* =========================================================
   SHADOW TEMPLE v2 — CORE PATCH FINAL
   - Volume default 45%
   - Icon volume topo esquerdo (pergaminho)
   - Pergaminho com animação real abrir/fechar
   - SELOS somente no menu
   - Admin senha: Projeto26
   - Fix de vídeo travando + fallback mp4 + play seguro
   - ESC fecha tudo, sem bug
========================================================= */

(function(){
  /* ===== Helpers ===== */
  const $ = (id)=>document.getElementById(id);
  const sleep = (ms)=>new Promise(r=>setTimeout(r,ms));

  /* ===== Elements ===== */
  const video = $("video");
  const videoBlur = $("videoBlur");
  const ambience = $("ambience");

  const loadingScreen = $("loadingScreen");
  const enterBox = $("enterBox");
  const enterHint = $("enterHint");
  const spinner = $("spinner");
  const dynamicText = $("dynamicText");

  const btnFS = $("btnFS");
  const btnSeals = $("btnSeals"); // (se tiver no teu layout)
  const sealsMenu = $("sealsMenu");

  const volumeHUD = $("volumeHUD");
  const volSlider = $("volSlider");
  const volIconBtn = $("volIconBtn");
  const volReadout = $("volReadout");
  const volState = $("volState");

  const admin = $("admin");
  const adminPass = $("adminPass");
  const adminAuth = $("adminAuth");
  const adminClear = $("adminClear");
  const adminStatus = $("adminStatus");
  const adminLogin = $("adminLogin");
  const adminDash = $("adminDash");

  const scrollOverlay = $("scrollOverlay");
  const scrollCloseBtn = $("scrollCloseBtn");
  const scrollInput = $("scrollInput");

  /* ===== Fallback: se IDs não existirem (caso sua parte 2 use outros nomes) ===== */
  const exists = (...els)=>els.every(Boolean);

  /* =========================================================
     1) VOLUME DEFAULT 45% + UI
  ========================================================= */
  function setVolume(v){
    const clamped = Math.max(0, Math.min(1, v));
    try{ video.volume = clamped; }catch(_){}
    try{ if (volSlider) volSlider.value = String(clamped); }catch(_){}
    try{
      const pct = Math.round(clamped*100);
      if (volReadout) volReadout.textContent = pct + "%";
      if (volumeHUD){
        volumeHUD.style.setProperty("--bars-w", Math.max(6,pct) + "%");
        volumeHUD.style.setProperty("--bars-a", String(0.25 + (pct/100)*0.55));
      }
      if (volState) volState.style.display = (pct===0) ? "inline-block" : "none";
    }catch(_){}
    try{
      if (ambience) ambience.volume = Math.min(0.35, Math.max(0.02, clamped*0.25));
    }catch(_){}
  }

  // força 45%
  if (video) setVolume(0.45);

  if (volSlider){
    volSlider.addEventListener("input", ()=>{
      setVolume(Number(volSlider.value));
    });
  }

  // abre/fecha painel de volume (estilo pergaminho)
  if (volIconBtn && volumeHUD){
    volIconBtn.addEventListener("click", (e)=>{
      e.stopPropagation();
      volumeHUD.classList.toggle("open");
    });
    document.addEventListener("click", ()=>volumeHUD.classList.remove("open"));
  }

  /* =========================================================
     2) FULLSCREEN
  ========================================================= */
  async function toggleFullscreen(){
    try{
      if (!document.fullscreenElement) await document.documentElement.requestFullscreen();
      else await document.exitFullscreen();
    }catch(_){}
  }
  window.toggleFullscreen = toggleFullscreen;
  if (btnFS) btnFS.addEventListener("click", toggleFullscreen);

  /* =========================================================
     3) SELOS MENU (abre/fecha)
  ========================================================= */
  function openSeals(){
    if (!sealsMenu) return;
    closeScroll();
    closeAdmin();
    sealsMenu.classList.add("show");
    triggerGlitch();
  }
  function closeSeals(){
    if (!sealsMenu) return;
    sealsMenu.classList.remove("show");
  }

  // caso exista um botão “SELOS” na tela normal:
  if (btnSeals) btnSeals.addEventListener("click", openSeals);

  /* =========================================================
     4) ADMIN (senha Projeto26)
  ========================================================= */
  const ADMIN_PASS = "Projeto26";

  function openAdmin(){
    if (!admin) return;
    closeScroll();
    closeSeals();
    admin.classList.add("show");
    triggerGlitch();
    setTimeout(()=>adminPass && adminPass.focus(), 120);
  }
  function closeAdmin(){
    if (!admin) return;
    admin.classList.remove("show");
  }
  window.openAdmin = openAdmin;
  window.closeAdmin = closeAdmin;

  function setAdminPill(type, text){
    if (!adminStatus) return;
    adminStatus.textContent = text;
    adminStatus.classList.remove("ok","bad");
    if (type) adminStatus.classList.add(type);
  }

  if (adminAuth){
    adminAuth.addEventListener("click", ()=>{
      const val = (adminPass?.value || "").trim();
      if (val === ADMIN_PASS){
        if (admin) admin.classList.add("dash");
        setAdminPill("ok","Acesso liberado.");
        triggerGlitch();
      }else{
        setAdminPill("bad","Chave incorreta.");
        triggerGlitch();
      }
    });
  }

  if (adminClear){
    adminClear.addEventListener("click", ()=>{
      if (adminPass) adminPass.value = "";
      setAdminPill(null,"Aguardando…");
    });
  }

  /* =========================================================
     5) PERGAMINHO (animação REAL)
     - abre com classe .show e .opening
     - fecha com .closing
  ========================================================= */
  function openScroll(){
    if (!scrollOverlay) return;
    closeAdmin();
    closeSeals();

    scrollOverlay.classList.remove("closing");
    scrollOverlay.classList.add("show","opening");
    setTimeout(()=>scrollOverlay.classList.remove("opening"), 460);

    triggerGlitch();
    setTimeout(()=>scrollInput && scrollInput.focus(), 260);
  }

  function closeScroll(){
    if (!scrollOverlay) return;
    if (!scrollOverlay.classList.contains("show")) return;

    scrollOverlay.classList.add("closing");
    scrollOverlay.classList.remove("opening");

    // tempo da animação
    setTimeout(()=>{
      scrollOverlay.classList.remove("show","closing");
    }, 420);
  }

  window.openScroll = openScroll;
  window.closeScroll = closeScroll;

  if (scrollCloseBtn) scrollCloseBtn.addEventListener("click", closeScroll);

  /* =========================================================
     6) ESC fecha TUDO
  ========================================================= */
  document.addEventListener("keydown", (e)=>{
    if (e.key === "Escape"){
      closeScroll();
      closeAdmin();
      closeSeals();
      if (volumeHUD) volumeHUD.classList.remove("open");
    }
  });

  /* =========================================================
     7) GLITCH/FLASH (se teu core já tiver triggerGlitch, usa o seu)
  ========================================================= */
  function triggerGlitch(){
    // se já existe um triggerGlitch no seu core, usa ele:
    if (typeof window.triggerGlitch === "function"){
      try{ window.triggerGlitch(); }catch(_){}
      return;
    }
    // fallback simples
    document.body.classList.remove("glitch-on");
    void document.body.offsetWidth;
    document.body.classList.add("glitch-on");
    setTimeout(()=>document.body.classList.remove("glitch-on"), 650);
  }
  window.triggerGlitch = triggerGlitch;

  /* =========================================================
     8) FIX: vídeo travando (play seguro + fallback mp4)
     - tenta reativar se travar
     - se webm falhar, troca para mp4
  ========================================================= */
  const FALLBACK_MP4 = "https://files.catbox.moe/8n2p6c.mp4"; // <<< você pode trocar depois

  async function safePlay(media){
    try{
      if (!media) return false;
      const p = media.play();
      if (p && typeof p.then === "function") await p;
      return true;
    }catch(_){
      return false;
    }
  }

  function swapToMp4(){
    try{
      const src = video.querySelector("source");
      if (!src) return;
      src.src = FALLBACK_MP4;
      src.type = "video/mp4";
      video.load();
      safePlay(video);
      if (videoBlur){
        const bsrc = videoBlur.querySelector("source");
        if (bsrc){
          bsrc.src = FALLBACK_MP4;
          bsrc.type = "video/mp4";
          videoBlur.load();
          safePlay(videoBlur);
        }
      }
      triggerGlitch();
    }catch(_){}
  }

  let stallWatch = null;
  function startStallWatch(){
    if (!video) return;
    if (stallWatch) clearInterval(stallWatch);
    let lastT = 0;
    let stuckCount = 0;

    stallWatch = setInterval(async ()=>{
      if (loadingScreen && getComputedStyle(loadingScreen).display !== "none") return; // não força durante ENTER

      const t = video.currentTime || 0;
      const playing = !video.paused && !video.ended && video.readyState >= 2;

      if (playing){
        if (Math.abs(t - lastT) < 0.01){
          stuckCount++;
        }else{
          stuckCount = 0;
        }
      }

      lastT = t;

      // se travou várias checagens seguidas:
      if (stuckCount >= 6){
        stuckCount = 0;
        // tenta “reacender”
        try{ video.pause(); }catch(_){}
        await sleep(80);
        const ok = await safePlay(video);
        if (!ok){
          swapToMp4();
        }
      }
    }, 700);
  }

  /* =========================================================
     9) ENTER FLOW: ao entrar, play media (sem bug de autoplay)
  ========================================================= */
  let hasEntered = false;

  async function doEnter(){
    if (hasEntered) return;
    hasEntered = true;

    // some com loading
    if (loadingScreen){
      loadingScreen.style.opacity = "0";
      setTimeout(()=>{ loadingScreen.style.display="none"; }, 520);
    }

    // play vídeo/blur/ambiente
    if (videoBlur) videoBlur.muted = true;
    await safePlay(video);
    if (videoBlur) await safePlay(videoBlur);

    // ambience pode ser bloqueado, mas tenta:
    if (ambience){
      ambience.volume = Math.min(0.35, Math.max(0.02, (video?.volume||0.45)*0.25));
      await safePlay(ambience);
    }

    // inicia watcher
    startStallWatch();

    // classe entered (se teu css usa)
    document.body.classList.add("entered");
    triggerGlitch();
  }

  // clique no ENTER
  if (enterBox){
    enterBox.addEventListener("click", doEnter);
  }
  // tecla ENTER
  document.addEventListener("keydown", (e)=>{
    if (e.key === "Enter"){
      // só se estiver no loading
      if (loadingScreen && getComputedStyle(loadingScreen).display !== "none"){
        doEnter();
      }
    }
  });

  /* =========================================================
     10) HOTKEYS (sem travar input)
  ========================================================= */
  document.addEventListener("keydown", (e)=>{
    const tag = (document.activeElement?.tagName || "").toLowerCase();
    const typing = tag === "input" || tag === "textarea";
    if (typing) return;

    const k = e.key.toLowerCase();
    if (k === "g"){ e.preventDefault(); openScroll(); }
    if (k === "a"){ e.preventDefault(); openAdmin(); }
    if (k === "s"){ e.preventDefault(); openSeals(); }
    if (k === "f"){ e.preventDefault(); toggleFullscreen(); }
  });

})();
</script>

<!-- ===============================
     CSS FINAL — Animação do Pergaminho + Icon volume “pergaminho”
     (se você já tem esses seletores, esse bloco só melhora)
================================ -->
<style>
/* Pergaminho: animação de abrir/fechar */
#scrollOverlay{
  transform: translateY(10px);
  opacity:0;
}
#scrollOverlay.show{
  opacity:1;
  transform: translateY(0);
}
#scrollOverlay.opening .scrollPanel{
  animation: scrollOpen .48s ease both;
}
#scrollOverlay.closing .scrollPanel{
  animation: scrollClose .42s ease both;
}
@keyframes scrollOpen{
  0%{ transform: translateY(22px) scale(.96); filter: blur(2px); opacity:0; }
  60%{ filter: blur(0); opacity:1; }
  100%{ transform: translateY(0) scale(1); opacity:1; }
}
@keyframes scrollClose{
  0%{ transform: translateY(0) scale(1); opacity:1; }
  100%{ transform: translateY(18px) scale(.96); opacity:0; filter: blur(2px); }
}

/* Ícone de volume: mais “pergaminho”, menos tech */
#volumeHUD{
  top:16px !important;
  left:16px !important;
  opacity:.92 !important;
  filter: drop-shadow(0 0 20px rgba(120,170,255,.10));
}
#volumeHUD .vol-btn{
  border-radius:16px !important;
  border:1px solid rgba(255,255,255,.12) !important;
  background:
    radial-gradient(circle at 20% 20%, rgba(255,255,255,.08), transparent 62%),
    linear-gradient(180deg, rgba(25,18,12,.70), rgba(0,0,0,.50)) !important;
}
#volumeHUD .vol-btn::before{
  background:
    radial-gradient(circle at 35% 30%, rgba(255,255,255,.08), transparent 55%),
    radial-gradient(circle at 70% 70%, rgba(120,170,255,.10), transparent 55%) !important;
}
</style>

</body>
</html>
